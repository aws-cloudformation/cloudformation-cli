{
    "$id": "aws.kms.key.v1.json",
    "resourceType": "AWS::KMS::Key",
    "definitions": {
        "Tag": {
            "type": "object",
            "properties": {
                "TagKey": {
                    "type": "string",
                    "minLength": 1,
                    "maxLength": 128
                },
                "TagValue": {
                    "type": "string",
                    "maxLength": 256
                }
            },
            "required": [
                "TagKey", "TagValue"
            ],
            "additionalProperties": false
        }
    },
    "properties": {
        "Arn": {
            "type": "string",
            "pattern": "^arn:aws(-(cn|gov))?:kms:([a-z]+-)+[0-9]:[0-9]{12}:[a-z0-9-]+$"
        },
        "Id": {
            "type": "string",
            "minLength": 1,
            "maxLength": 2048
        },
        "Description": {
            "type": "string",
            "maxLength": 8192
        },
        "Enabled": {
            "type": "boolean"
        },
        "EnableKeyRotation": {
            "type": "boolean"
        },
        "KeyPolicy": {
            "type": "object"
        },
        "KeyUsage": {
            "type": "string",
            "enum": [
                "ENCRYPT_DECRYPT"
            ]
        },
        "Origin": {
            "type": "string",
            "enum": [
                "AWS_KMS", "EXTERNAL"
            ]
        },
        "Tags": {
            "type": "array",
            "items": {
                "$ref": "#/definitions/Tag"
            }
        }
    },
    "readOnly": [
        "Arn", "Id"
    ],
    "required": [
        "KeyPolicy"
    ],
    "additionalProperties": false
}